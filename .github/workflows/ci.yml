.windows_runners:
  tags: [shared-windows, windows, windows-1809]
  before_script:
    - cd MyProject.MyProject

stages:
  - build
  - test

workflow:
  rules:
    - when: always
  
build-job:
  stage: build
  extends:
    - .windows_runners
  script:
    - dotnet restore
    - dotnet build

test:
  stage: test
  extends:
    - .windows_runners
  script:
    - 'dotnet test --logger "html;LogFileName=test-results.html;MethodFormat=Class;FailureBodyFormat=Verbose"'
  artifacts:
    when: always
    paths:
      - $CI_PROJECT_DIR\**\test-results.html
    expire_in: 1 week